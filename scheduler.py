from toolbox import Toolboximport datetime"""Opens sorted access file and returns arrayParameters:    sortedAccessFile(str): Name of access file to parse    Returns:    accessArray(list): List of access with"""def OpenAccess(sortedAccessFile):    accessFile = open(sortedAccessFile,'r')    lines = accessFile.readlines()        accessArray = []    for i in range(len(lines)):        accessArray.append(lines[i].split(','))            accessFile.close()            return accessArray"""Finds any time conflicts for a possible transition into imaging mode by comparing to other established actionsParameters:    requestedTime(list): A list containing the start and end times (as strings)    actions(list): A list containing all previously established actions    Returns:    boolean: True if there is a conflict. False if there is no conflict."""def FindConflict(requestedTime, actions):    startTime = Toolbox.ConvertTime(requestedTime[0])    endTime = Toolbox.ConvertTime(requestedTime[1]) + datetime.timedelta(minutes=30)        for i in range(len(actions)):        currentStartTime = Toolbox.ConvertTime(actions[i][0])        currentEndTime = Toolbox.ConvertTime(actions[i][1])                #check for any time conflicts with pre-existing actions        if ((Toolbox.CompareTime(startTime,currentStartTime) and            not Toolbox.CompareTime(startTime,currentEndTime)) or                         (Toolbox.CompareTime(endTime,currentStartTime) and            not Toolbox.CompareTime(endTime,currentEndTime)) or                    (Toolbox.CompareTime(currentStartTime,startTime) and            not Toolbox.CompareTime(currentStartTime, endTime)) or                        (Toolbox.CompareTime(currentEndTime,startTime) and             not Toolbox.CompareTime(currentEndTime, endTime))):                return True            return False    """Schedule modes based on the the access that is provided.Scheduling follows the following precedent:    1. Data downlink    2. Imaging + data processing    3. Cruise modeThis means that data downlink is always chosen if the opportunity is given.With data downlink opportunities chosen, the access is parsed and chosen offthe following criteria: if the time of the access plus 30 minutes for a transitionto data processing mode does not conflict with any previously scheduled modes.The remaining time between the modes is automatically scheduled as cruise mode.Parameters:    accessArray(list): List that contains all sorted access times    Returns:    acceptedActions(list): A list that contains all scheduled mode transitions"""def Schedule(accessArray):    acceptedActions = []    deleteIndices = []    #Find all data downlink times    for i in range(len(accessArray)):        if (accessArray[i][2].replace('\n','') == 'GroundStation'):            acceptedActions.append([accessArray[i][0],                                    accessArray[i][1],                                    accessArray[i][2].replace('\n',''),                                    'data_downlink'])            deleteIndices.append(i)          #remove data downlink times from future consideration    for i in range(len(deleteIndices)):        del accessArray[deleteIndices[len(deleteIndices)-1-i]]        deleteIndices = []    #find non-conflicting access    for i in range(len(accessArray)):        conflict = FindConflict((accessArray[i][0],accessArray[i][1]),acceptedActions)        if not conflict:            acceptedActions.append([accessArray[i][0],                                    accessArray[i][1],                                    accessArray[i][2].replace('\n',''),                                    'imaging'])                        procEndTime = Toolbox.ConvertTime(accessArray[i][1]) + \                            datetime.timedelta(minutes=30)            procEndTime = Toolbox.ConvertTime(procEndTime)            acceptedActions.append([accessArray[i][1],                                    procEndTime,                                    "NA",                                    "image_processing"])            deleteIndices.append(i)                #remove imaging times from future consideration    for i in range(len(deleteIndices)):        del accessArray[deleteIndices[len(deleteIndices)-1-i]]            actionsLength = len(acceptedActions)    i = 0    while i < (actionsLength - 1):        if acceptedActions[i][1] != acceptedActions[i+1][0]:            acceptedActions.append([acceptedActions[i][1],                                    acceptedActions[i+1][0],                                    "NA",                                    "cruise"])                i += 1            return Toolbox.SortAllAccess(acceptedActions)